(function(t){function e(e){for(var s,r,i=e[0],c=e[1],u=e[2],l=0,m=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);p&&p(e);while(m.length)m.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,r=1;r<n.length;r++){var i=n[r];0!==o[i]&&(s=!1)}s&&(a.splice(e--,1),t=c(c.s=n[0]))}return t}var s={},r={app:0},o={app:0},a=[];function i(t){return c.p+"js/"+({about:"about"}[t]||t)+"."+{about:"280bc23b"}[t]+".js"}function c(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={about:1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise(function(e,n){for(var s="css/"+({about:"about"}[t]||t)+"."+{about:"1374ab2c"}[t]+".css",o=c.p+s,a=document.getElementsByTagName("link"),i=0;i<a.length;i++){var u=a[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===s||l===o))return e()}var m=document.getElementsByTagName("style");for(i=0;i<m.length;i++){u=m[i],l=u.getAttribute("data-href");if(l===s||l===o)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var s=e&&e.target&&e.target.src||o,a=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=s,delete r[t],p.parentNode.removeChild(p),n(a)},p.href=o;var g=document.getElementsByTagName("head")[0];g.appendChild(p)}).then(function(){r[t]=0}));var s=o[t];if(0!==s)if(s)e.push(s[2]);else{var a=new Promise(function(e,n){s=o[t]=[e,n]});e.push(s[2]=a);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(t);var m=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(p);var n=o[t];if(0!==n){if(n){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;m.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",m.name="ChunkLoadError",m.type=s,m.request=r,n[1](m)}o[t]=void 0}};var p=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=s,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(n,s,function(e){return t[e]}.bind(null,s));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/public/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var m=0;m<u.length;m++)e(u[m]);var p=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var s=n("64a9"),r=n.n(s);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("7f7f"),n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{},attrs:{id:"app"}},[n("router-view")],1)},o=[],a={name:"app",data:function(){return{}}},i=a,c=(n("034f"),n("2877")),u=Object(c["a"])(i,r,o,!1,null,null,null),l=u.exports,m=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index"},[n("van-nav-bar",{attrs:{title:"在线好友("+(this.chatUserList.length-1)+")"}},[n("div",{staticStyle:{height:"46px","line-height":"46px"},attrs:{slot:"right"},slot:"right"},[n("i",{staticStyle:{color:"rgb(30, 228, 32)"}},[t._v("•")]),t._v(" 在线\n    ")])]),n("van-cell-group",t._l(this.chatUserList,function(e){return e.name!=t.name?n("van-cell",{attrs:{value:"12:00",to:{name:"message",params:{to_name:e.name}}}},[n("template",{slot:"icon"},[n("van-icon",{staticClass:"custom-icon",attrs:{size:"60px",name:"http://juntao.oss-cn-shenzhen.aliyuncs.com/images/wechat/avatar/xX9hSG0utRz0hmC4hA5b4nWL46Jgn8YGhQ7psWyU.png"}})],1),n("template",{slot:"title"},[n("div",{staticStyle:{"padding-left":"10px"}},[n("span",{staticClass:"custom-text"},[t._v(t._s(e.name))]),n("p",{staticStyle:{margin:"5px 0",color:"rgb(152, 152, 152)"}},[t._v(t._s(t.name))])])])],2):t._e()}),1),n("van-button",{attrs:{type:"default"},on:{click:t.debug}},[t._v("默认按钮")]),n("van-tabbar",{staticStyle:{height:"55px"},attrs:{route:""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[n("van-tabbar-item",{attrs:{replace:"",to:"/",info:"10",icon:"chat"}},[t._v("消息")]),n("van-tabbar-item",{attrs:{replace:"",to:"/about",icon:"manager"}},[t._v("个人")])],1)],1)},g=[],d=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),h=n("2f62");function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach(function(e){Object(d["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var b={name:"index",data:function(){return{active:0,list:[],name:""}},created:function(){this.name=this.$store.getters.user},methods:{debug:function(){console.log(this.$store.getters.getRecord)}},computed:v({},Object(h["b"])(["chatUserList"])),components:{}},w=b,y=Object(c["a"])(w,p,g,!1,null,null,null),j=y.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Message"},[n("van-nav-bar",{attrs:{"left-text":"返回",title:this.$route.params.to_name,"left-arrow":""},on:{"click-left":t.onClickLeft}}),n("div",{staticStyle:{"padding-bottom":"300px"}},t._l(t.records,function(e){return n("div",{staticStyle:{"margin-top":"15px"}},[n("div",{style:e.is_me?"padding:0 15px 0 0;float:right":"padding:0 0 0 15px;float:left"},[n("van-icon",{attrs:{size:"40px",name:"http://juntao.oss-cn-shenzhen.aliyuncs.com/images/wechat/avatar/xX9hSG0utRz0hmC4hA5b4nWL46Jgn8YGhQ7psWyU.png"}})],1),n("div",{staticClass:"msg-content"},[n("div",{class:e.is_me?"right-msg":"left-msg",staticStyle:{"word-wrap":"break-word"}},[t._v("\n          "+t._s(1==e.type?e.content:"")+"\n          "),2==e.type?n("img",{attrs:{src:e.content}}):t._e()])])])}),0),n("div",{staticClass:"send"},[n("van-row",[n("van-col",{staticClass:"controller",attrs:{span:"24"}},[n("div",{staticClass:"one"},[n("van-icon",{staticClass:"my-icon",attrs:{size:"20px",name:"volume",color:"#737373"}})],1),n("div",{staticClass:"two"},[n("van-field",{attrs:{placeholder:"请输入"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send(e)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),n("div",{staticClass:"three"},[n("van-icon",{staticClass:"my-icon",attrs:{size:"20px",name:"smile-o",color:"#737373"},on:{click:function(e){return t.showBottom("emoji")}}}),n("van-icon",{staticClass:"my-icon",attrs:{size:"20px",name:"add",color:"#737373"},on:{click:function(e){return t.showBottom("pic")}}})],1)])],1),"emoji"==t.active?n("van-row",[n("van-col",{staticClass:"smile-content",staticStyle:{"background-color":"#f8f8f8"},attrs:{span:"24"}},[n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/1.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/198.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/201.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/202.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/429.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/430.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/431.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/432.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/434.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/438.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/460.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/701.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/705.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/703.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/706.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/719.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/720.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/725.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/728.png",alt:""},on:{click:t.sendEmoji}}),n("img",{staticClass:"smile-icon",attrs:{src:"https://raw.githubusercontent.com/tmm1/emoji-extractor/master/images/160x160/741.png",alt:""},on:{click:t.sendEmoji}})])],1):t._e(),"pic"==t.active?n("van-row",[n("van-col",{staticStyle:{"background-color":"#f8f8f8"},attrs:{span:"24"}},[n("van-uploader",{staticStyle:{margin:"20px 15px"},attrs:{"after-read":t.onRead}},[n("van-icon",{staticClass:"send-pic",attrs:{size:"45px",name:"photo",color:"#737373"}}),n("div",{staticStyle:{"text-align":"center","font-size":"14px"}},[t._v("上传图片")])],1)],1)],1):t._e()],1)],1)},E=[];function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(n,!0).forEach(function(e){Object(d["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var k={name:"Message",data:function(){return{active:"",emoji:"http://juntao.oss-cn-shenzhen.aliyuncs.com/images/video/courses/packages/f2HQCKV4GMcG4Ajfu0z4eXHEJQ5vOdW6S3Mcc4oo.jpeg",value:"",records:{}}},components:{},created:function(){this.records=this.$store.getters.getRecordBy(this.$route.params.to_name)},methods:{onClickLeft:function(){this.$router.push({name:"index",params:{}})},showBottom:function(t){this.active!=t?this.active=t:this.active=""},send:function(){var t={Source:1,From:this.user,To:this.$route.params.to_name,Type:1,Content:this.value,SendAt:"2015"},e={from:this.$route.params.to_name,type:1,is_me:!0,content:this.value};this.$store.dispatch("giveMe",e),this.ws.send(JSON.stringify(t)),this.value=""},onRead:function(t){console.log(t)},sendEmoji:function(t){console.log(t.currentTarget.src);var e={Source:1,From:this.user,To:this.$route.params.to_name,Type:2,Content:t.currentTarget.src,SendAt:"2015"},n={from:this.$route.params.to_name,type:2,is_me:!0,content:t.currentTarget.src};this.$store.dispatch("giveMe",n),this.ws.send(JSON.stringify(e))}},computed:x({},Object(h["b"])(["ws","user"]))},_=k,C=(n("bd5c"),Object(c["a"])(_,O,E,!1,null,null,null)),T=C.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"loign"},[n("van-cell-group",[n("van-field",{attrs:{required:"",clearable:"",label:"用户名","right-icon":"question-o",placeholder:"请输入用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),n("van-field",{attrs:{type:"password",label:"密码",placeholder:"请输入密码",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("van-button",{staticClass:"login-btn",attrs:{type:"default",size:"large"},on:{click:t.login}},[t._v("提交")])],1)},R=[];function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(n,!0).forEach(function(e){Object(d["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var U={name:"login",data:function(){return{username:"",password:""}},methods:{login:function(){this.$store.dispatch("InitWebSocket",{username:this.username,password:this.password}),this.ws.onopen=this.websocketOnOpen,this.ws.onmessage=this.websocketOnMessage,this.ws.onclose=this.websocketClose,this.ws.onerror=this.websocketError,1==this.$store.getters.isLogin&&this.$router.push({name:"index",params:{}})},websocketOnOpen:function(){var t={Source:4,From:this.user,To:"",Type:0,SendAt:""};this.$store.getters.ws.send(JSON.stringify(t)),this.reset()},reset:function(){clearTimeout(this.$store.getters.timeoutObj),this.start()},start:function(){var t=this,e=setTimeout(function(){var e={type:"ping"};t.send(JSON.stringify(e))},this.timeout);this.$store.dispatch("SetTimeout",e)},websocketOnMessage:function(t){var e=JSON.parse(t.data);console.log(t.data),this.msgHandle(e),this.reset()},websocketClose:function(t){console.log("connection closed ("+t.code+")"),!1===this.state.websocket.login&&this.reconnect(this.state.websocket.url)},send:function(t){this.ws.send(t)},websocketError:function(t){this.reconnect(this.state.websocket.url)},reconnect:function(){var t=this;if(!this.state.websocket.lockReconnect){this.state.websocket.lockReconnect=!0;var e=this;setTimeout(function(){t.initWebSocket(e.user,e.state.websocket.password),t.state.websocket.lockReconnect=!1},2e3)}},msgHandle:function(t){switch(t.Source){case 1:this.giveMe(t);break;case 2:break;case 3:break;case 4:this.getUserList(t);break;case 5:this.addUser(t);break;case 6:this.removeUser(t);break}},getUserList:function(t){var e=JSON.parse(t.Content);this.$store.dispatch("setList",e)},giveMe:function(t){var e={from:t.From,type:t.Type,is_me:!1,content:t.Content};console.log(e),this.$store.dispatch("giveMe",e)},addUser:function(t){var e={name:t.Content};this.$store.dispatch("addUser",e),console.log(e),this.$store.dispatch("addRecord",t.Content)},removeUser:function(t){this.$store.dispatch("removeUser",t.Content)}},computed:$({},Object(h["b"])(["ws","user"])),components:{}},D=U,A=(n("d6db"),Object(c["a"])(D,P,R,!1,null,null,null)),M=A.exports;s["a"].use(m["a"]);var N=new m["a"]({routes:[{path:"/",name:"index",component:j},{path:"/message",name:"message",component:T},{path:"/login",name:"login",component:M},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]}),z=n("4592"),J={state:{ws:"",name:"",pwd:"",url:"ws://"+location.host+"/ws",timeoutObj:"",login:!1,lockReconnect:!1},mutations:{SET_WS:function(t,e){t.ws=e},SET_NAME:function(t,e){t.name=e},SET_PWD:function(t,e){t.pwd=e},SET_TIMEOUTOBJ:function(t,e){t.timeoutObj=e},SET_LOGIN:function(t,e){t.login=e}},getters:{isLogin:function(t){return t.login},ws:function(t){return t.ws},timeoutObj:function(t){return t.timeoutObj},user:function(t){return t.name}},actions:{InitWebSocket:function(t,e){var n=t.commit,s=t.state;n("SET_NAME",e.username),n("SET_PWD",e.password),n("SET_LOGIN",!0);var r=new WebSocket(s.url+"?name="+e.username+"&password="+e.password);n("SET_WS",r)},SendMsg:function(t){this.state.websocket.ws.send(t)},SetTimeout:function(t,e){var n=t.commit;n("SET_TIMEOUTOBJ",e)}}},W=J,B=(n("ac4d"),n("8a81"),{state:{username:"",avatar:"",userList:[],record:{}},mutations:{SET_USERNAME:function(t,e){t.username=e},SET_AVATAR:function(t,e){t.avatar=e},SET_USERLIST:function(t,e){t.userList=e;var n=!0,s=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var i=o.value;t.record[i.name]=[]}}catch(c){s=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(s)throw r}}},SET_ADDUSER:function(t,e){t.userList.push(e)},SET_RENOVEUSER:function(t,e){var n=0;for(var s in t.userList)if(t.userList[s].name==e){n=s;break}t.userList.splice(n,1)},SET_RECOR:function(t,e){t.record[e]=[]},SET_ADDRECOR:function(t,e){t.record[e.from].push(e)}},getters:{name:function(t){return t.username},chatUserList:function(t){return t.userList},getRecordBy:function(t){return function(e){return t.record[e]}},getRecord:function(t){return t.record}},actions:{setList:function(t,e){var n=t.commit;n("SET_USERLIST",e)},removeUser:function(t,e){var n=t.commit;n("SET_RENOVEUSER",e)},giveMe:function(t,e){var n=t.commit;console.log(4545444545445454),console.log(e),n("SET_ADDRECOR",e)},addUser:function(t,e){var n=t.commit;n("SET_ADDUSER",e)},addRecord:function(t,e){var n=t.commit;n("SET_RECOR",e)}}}),I=B;s["a"].use(h["a"]);var G=new h["a"].Store({modules:{websocket:W,chat:I}}),q=G;n("7c88");s["a"].use(z["a"]),s["a"].config.productionTip=!1,N.beforeEach(function(t,e,n){q.getters.isLogin?("login"==t.name&&n({path:"/"}),n()):"login"==t.name?n():n({path:"/login"})}),new s["a"]({router:N,store:q,render:function(t){return t(l)}}).$mount("#app")},"64a9":function(t,e,n){},a9e7:function(t,e,n){},bd5c:function(t,e,n){"use strict";var s=n("dcc7"),r=n.n(s);r.a},d6db:function(t,e,n){"use strict";var s=n("a9e7"),r=n.n(s);r.a},dcc7:function(t,e,n){}});
//# sourceMappingURL=app.2d9a29d7.js.map